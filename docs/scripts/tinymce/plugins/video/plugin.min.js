!function(e){"use strict";const l=["youtube","vimeo"];function h(n){const o={};return l.forEach(function(e){var t=l[e],i=n.match(t.pattern);if(i)return o.name=e,e=i[1],i=t.api+e,o.url=i,o}),0!==Object.keys(o).length&&o}function i(e,t){this.showDialog=this.showDialog.bind(this),this.render=this.render.bind(this);const i=this;i.editor=e,i.currentProvider=null,this.configs={},this.configs.unknown={title:"Insert a video",initialData:{},body:{type:"panel",items:[{type:"input",label:"Source",name:"url"},{type:"grid",columns:3,items:[{type:"input",label:"Width",name:"width"},{type:"input",label:"Height",name:"height"},{type:"checkbox",label:"Fullscreen",name:"fullscreen"}]},{type:"htmlpanel",html:"<div id='options'></div>"},{type:"htmlpanel",html:"<div id='preview'></div>"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onChange:function(e){i.providerChange(e),i.render()},onSubmit:function(e){i.onsubmit(),e.close()}},this.configs.youtube={title:"Insert a video",initialData:{},body:{type:"panel",items:[{type:"input",label:"Source",name:"url"},{type:"grid",columns:3,items:[{type:"input",label:"Width",name:"width"},{type:"input",label:"Height",name:"height"},{type:"checkbox",label:"Fullscreen",name:"fullscreen"}]},{type:"checkbox",label:"Show suggested videos when the video finishes",name:"rel"},{type:"checkbox",label:"Show player controls",name:"controls"},{type:"checkbox",label:"Show video title and player actions",name:"showinfo"},{type:"htmlpanel",html:"<div id='preview'></div>"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onChange:function(e){i.providerChange(e),i.render()},onSubmit:function(e){i.onsubmit(),e.close()}},this.configs.vimeo={title:"Insert a video",initialData:{},body:{type:"panel",items:[{type:"input",label:"Source",name:"url"},{type:"grid",columns:3,items:[{type:"input",label:"Width",name:"width"},{type:"input",label:"Height",name:"height"},{type:"checkbox",label:"Fullscreen",name:"fullscreen"}]},{type:"checkbox",label:"Show portrait in overlay",name:"portrait"},{type:"checkbox",label:"Show title in overlay",name:"title"},{type:"checkbox",label:"Show byline in overlay",name:"byline"},{type:"htmlpanel",html:"<div id='preview'></div>"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onChange:function(e){i.providerChange(e),i.render()},onSubmit:function(e){i.onsubmit(),e.close()}};e.ui.registry.addIcon("video",`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 48 48" xml:space="preserve"><g><g><g>
      <path d="M44,4.982H4c-2.2,0-4,1.8-4,4v30.036c0,2.2,1.8,4,4,4h40c2.2,0,4-1.8,4-4V8.982C48,6.782,46.2,4.982,44,4.982z M20.204,12.789l9.593,6.55l-9.593,6.55V12.789z M40.001,35.212H18.875c-0.57,1.239-1.816,2.104-3.27,2.104 s-2.699-0.866-3.27-2.104H8c-0.829,0-1.5-0.673-1.5-1.5c0-0.828,0.671-1.5,1.5-1.5h4.336c0.57-1.24,1.815-2.106,3.27-2.106 s2.7,0.866,3.27,2.106h21.126c0.828,0,1.5,0.672,1.5,1.5C41.502,34.54,40.829,35.212,40.001,35.212z" fill="#333333"/>
      <circle cx="15.605" cy="33.712" r="1.397" fill="#333333"/>
    </g></g></g></svg>`),e.ui.registry.addButton("video",{icon:"video",tooltip:"Insert/edit video",onAction:e=>i.showDialog()}),e.ui.registry.addMenuItem("video",{icon:"video",text:"Video",onAction:e=>i.showDialog(),context:"insert"})}l.youtube={pattern:/youtu(?:\.be|be\.com)\/(?:watch\?v=|embed\/)?([a-z0-9\-_]+)(?:\?|&)?(.+)?/i,api:"//www.youtube.com/embed/",options:[{name:"rel",type:"checkbox",text:"Show suggested videos when the video finishes"},{name:"controls",type:"checkbox",text:"Show player controls"},{name:"showinfo",type:"checkbox",text:"Show video title and player actions"}]},l.vimeo={pattern:/(?:player.)?vimeo.com\/(?:video\/)?([0-9]+)(?:\?|&)?(.+)?/,api:"//player.vimeo.com/video/",options:[{name:"portrait",type:"checkbox",text:"Show portrait in overlay"},{name:"title",type:"checkbox",text:"Show title in overlay"},{name:"byline",type:"checkbox",text:"Show byline in overlay"}]},i.prototype.showDialog=function(){var e=this.editor,t=e.dom;const i={};let n=e.selection.getNode();if(n){let e=t.getAttrib(n,"src");e||(n=n.children[0],e=t.getAttrib(n,"src")),i.url=e,t.getAttrib(n,"allowfullscreen")&&(i.fullscreen=!0),i.width=t.getAttrib(n,"width"),i.height=t.getAttrib(n,"height")}i.width||(i.width="400"),i.height||(i.height="300"),this.window=null;e=h(i.url);if("youtube"===e.name||"vimeo"===e.name){t=i.url.split("?")[1];const o=new URLSearchParams(t);t=l[e.name].options||[],t=(i.url=e.url,t.forEach(function(e){var e=e.name,t=o.get(e);i[e]="0"!==t&&!1!==t}),this.configs[e.name]);t.initialData=i,this.currentProvider=e.name,this.window=this.editor.windowManager.open(t)}else{e=this.configs.unknown;e.initialData=i,this.currentProvider=null,this.window=this.editor.windowManager.open(e)}this.render()},i.prototype.providerChange=function(e){var t,i=e.getData(),n=h(i.url);n.name===this.currentProvider||null===this.currentProvider&&!1===n||("youtube"===n.name?(i.rel=!0,i.controls=!0,i.showinfo=!0,(t=this.configs[n.name]).initialData=i,e.redial(t),this.currentProvider=n.name):"vimeo"===n.name?(i.portrait=!0,i.title=!0,i.byline=!0,(t=this.configs[n.name]).initialData=i,e.redial(t),this.currentProvider=n.name):((t=this.configs.unknown).initialData=i,e.redial(t),this.currentProvider=null))},i.prototype.render=function(){var e=this.window.getData(),t=this.html(!0);return e.url?(t=this.html(!0),$AM.find("#preview")[0].innerHTML=t):""},i.prototype.html=function(e){const i=this.window.getData();let t=i.url;var n=h(i.url);const o=[];n&&((l[n.name].options||[]).forEach(function(e){var e=e.name,t=i[e];"0"!==t&&!1!==t||o.push(e+"=0")}),t=n.url),o.length&&(t+="?"+o.join("&"));var n=i.width,a=i.height;let r="<iframe src='"+t+"' width='"+n+"' height='"+a+"'";return i.fullscreen&&(r+=" allowfullscreen"),e&&(r+=" style='width: "+n+"px; height: "+a+"px;'"),r+=" ></iframe>"},i.prototype.onsubmit=function(){this.editor.insertContent(this.html())},e.PluginManager.add("video",(e,t)=>{new i(e);return{getMetadata:()=>({name:"Video - Add embeded video easily.",url:"http://www.brandextract.com"})}})}(window.tinymce);